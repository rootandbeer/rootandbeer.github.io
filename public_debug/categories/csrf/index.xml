<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Csrf on root&amp;beer</title>
    <link>http://rootandbeer.com/categories/csrf/</link>
    <description>Recent content in Csrf on root&amp;beer</description>
    <generator>Hugo</generator>
    <language>en</language>
    <copyright>Copyright Â© 2026 root&amp;beer. All Rights Reserved.</copyright>
    <lastBuildDate>Mon, 02 Feb 2026 18:51:59 -0800</lastBuildDate>
    <atom:link href="http://rootandbeer.com/categories/csrf/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Cross-Site Request Forgery (CSRF/XSRF)</title>
      <link>http://rootandbeer.com/docs/exploitation--enumeration/web/csrf/</link>
      <pubDate>Sat, 10 Jan 2026 16:03:53 -0800</pubDate>
      <guid>http://rootandbeer.com/docs/exploitation--enumeration/web/csrf/</guid>
      <description>&lt;div id=&#34;doc-vars-form-container&#34; class=&#34;doc-vars-form-wrapper mb-4 doc-vars-project-shortcode&#34; data-doc-vars=&#34;RHOST,LHOST,RPORT,LPORT&#34;&gt;&#xA;  &lt;div class=&#34;row g-2 align-items-end&#34;&gt;&lt;div class=&#34;col-12 col-sm-6 col-md-3&#34;&gt;&#xA;      &lt;label for=&#34;doc-var-RHOST&#34; class=&#34;form-label&#34;&gt;$RHOST&lt;/label&gt;&#xA;      &lt;input type=&#34;text&#34; class=&#34;form-control form-control-sm&#34; id=&#34;doc-var-RHOST&#34; name=&#34;RHOST&#34; placeholder=&#34;10.0.0.1&#34; autocomplete=&#34;off&#34;&gt;&#xA;    &lt;/div&gt;&lt;div class=&#34;col-12 col-sm-6 col-md-3&#34;&gt;&#xA;      &lt;label for=&#34;doc-var-LHOST&#34; class=&#34;form-label&#34;&gt;$LHOST&lt;/label&gt;&#xA;      &lt;input type=&#34;text&#34; class=&#34;form-control form-control-sm&#34; id=&#34;doc-var-LHOST&#34; name=&#34;LHOST&#34; placeholder=&#34;192.168.1.1&#34; autocomplete=&#34;off&#34;&gt;&#xA;    &lt;/div&gt;&lt;div class=&#34;col-12 col-sm-6 col-md-3&#34;&gt;&#xA;      &lt;label for=&#34;doc-var-RPORT&#34; class=&#34;form-label&#34;&gt;$RPORT&lt;/label&gt;&#xA;      &lt;input type=&#34;text&#34; class=&#34;form-control form-control-sm&#34; id=&#34;doc-var-RPORT&#34; name=&#34;RPORT&#34; placeholder=&#34;80&#34; autocomplete=&#34;off&#34;&gt;&#xA;    &lt;/div&gt;&lt;div class=&#34;col-12 col-sm-6 col-md-3&#34;&gt;&#xA;      &lt;label for=&#34;doc-var-LPORT&#34; class=&#34;form-label&#34;&gt;$LPORT&lt;/label&gt;&#xA;      &lt;input type=&#34;text&#34; class=&#34;form-control form-control-sm&#34; id=&#34;doc-var-LPORT&#34; name=&#34;LPORT&#34; placeholder=&#34;4444&#34; autocomplete=&#34;off&#34;&gt;&#xA;    &lt;/div&gt;&lt;div class=&#34;col-12 col-sm-6 col-md-2&#34;&gt;&#xA;      &lt;button type=&#34;button&#34; class=&#34;btn btn-secondary btn-sm w-100&#34; id=&#34;doc-vars-reset&#34;&gt;Reset&lt;/button&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;script&gt;&#xA;(function () {&#xA;  var STORAGE_KEY = &#39;doc-vars&#39;;&#xA;  var VAR_NAMES = [];&#xA;&#xA;  function getMain() {&#xA;    return document.querySelector(&#39;.hb-main&#39;) || document.querySelector(&#39;main&#39;) || document.querySelector(&#39;[class*=&#34;content&#34;]&#39;);&#xA;  }&#xA;&#xA;  function getFormContainer() {&#xA;    return document.getElementById(&#39;doc-vars-form-container&#39;);&#xA;  }&#xA;&#xA;  function getVars() {&#xA;    var container = getFormContainer();&#xA;    if (!container) return {};&#xA;    var vars = {};&#xA;    VAR_NAMES.forEach(function (name) {&#xA;      var el = container.querySelector(&#39;[name=&#34;&#39; + name + &#39;&#34;]&#39;);&#xA;      vars[name] = el ? el.value.trim() : &#39;&#39;;&#xA;    });&#xA;    return vars;&#xA;  }&#xA;&#xA;  function setVars(vars) {&#xA;    var container = getFormContainer();&#xA;    if (!container) return;&#xA;    VAR_NAMES.forEach(function (name) {&#xA;      var el = container.querySelector(&#39;[name=&#34;&#39; + name + &#39;&#34;]&#39;);&#xA;      if (el &amp;&amp; vars[name] !== undefined) el.value = vars[name];&#xA;    });&#xA;  }&#xA;&#xA;  function substitute(html, vars) {&#xA;    var out = html;&#xA;    VAR_NAMES.forEach(function (name) {&#xA;      var val = (vars[name] !== undefined &amp;&amp; vars[name] !== &#39;&#39;) ? vars[name] : &#39;$&#39; + name;&#xA;      out = out.split(&#39;${&#39; + name + &#39;}&#39;).join(val);&#xA;    });&#xA;    var sorted = VAR_NAMES.slice().sort(function (a, b) { return b.length - a.length; });&#xA;    sorted.forEach(function (name) {&#xA;      var val = (vars[name] !== undefined &amp;&amp; vars[name] !== &#39;&#39;) ? vars[name] : &#39;$&#39; + name;&#xA;      var escaped = name.replace(/[.*+?^${}()|[\]\\]/g, &#39;\\$&amp;&#39;);&#xA;      var regex = new RegExp(&#39;\\$&#39; + escaped + &#39;(?![\\w])&#39;, &#39;g&#39;);&#xA;      out = out.replace(regex, val);&#xA;    });&#xA;    return out;&#xA;  }&#xA;&#xA;  function applySubstitution() {&#xA;    var main = getMain();&#xA;    var formContainer = getFormContainer();&#xA;    if (!main || !formContainer || !contentStore.length) return;&#xA;    var vars = getVars();&#xA;    contentStore.forEach(function (entry) {&#xA;      if (!entry.node || !entry.node.parentNode) return;&#xA;      if (entry.node.contains &amp;&amp; entry.node.contains(formContainer)) return;&#xA;      var out = substitute(entry.originalHTML, vars);&#xA;      if (out.indexOf(FORM_PLACEHOLDER) !== -1) {&#xA;        out = out.replace(FORM_PLACEHOLDER, formContainer.outerHTML);&#xA;      }&#xA;      entry.node.innerHTML = out;&#xA;    });&#xA;    formContainerRef = getFormContainer();&#xA;  }&#xA;&#xA;  function saveToStorage() {&#xA;    try {&#xA;      var vars = getVars();&#xA;      localStorage.setItem(STORAGE_KEY, JSON.stringify(vars));&#xA;    } catch (e) {}&#xA;  }&#xA;&#xA;  function loadFromStorage() {&#xA;    try {&#xA;      var raw = localStorage.getItem(STORAGE_KEY);&#xA;      if (raw) {&#xA;        var vars = JSON.parse(raw);&#xA;        setVars(vars);&#xA;        applySubstitution();&#xA;      }&#xA;    } catch (e) {}&#xA;  }&#xA;&#xA;  function resetForm() {&#xA;    var empty = {};&#xA;    VAR_NAMES.forEach(function (name) { empty[name] = &#39;&#39;; });&#xA;    setVars(empty);&#xA;    saveToStorage();&#xA;    applySubstitution();&#xA;  }&#xA;&#xA;  var FORM_PLACEHOLDER = &#39;\x3C!--__DOC_VARS_FORM__--&gt;&#39;;&#xA;  var contentStore = [];&#xA;  var formContainerRef = null;&#xA;  var trueOriginals = null;&#xA;&#xA;  function getDocContentNodes(main, formContainer) {&#xA;    var byClass = main.querySelectorAll(&#39;.hb-docs-doc-content&#39;);&#xA;    if (byClass.length &gt; 0) {&#xA;      var nodes = Array.prototype.slice.call(byClass);&#xA;      var out = [];&#xA;      for (var i = 0; i &lt; nodes.length; i++) {&#xA;        if (nodes[i].contains &amp;&amp; nodes[i].contains(formContainer)) {&#xA;          var siblings = Array.prototype.slice.call(formContainer.parentNode.children).filter(function (el) { return el !== formContainer; });&#xA;          out = out.concat(siblings);&#xA;        } else {&#xA;          out.push(nodes[i]);&#xA;        }&#xA;      }&#xA;      return out.length ? out : nodes;&#xA;    }&#xA;    var children = Array.prototype.slice.call(main.children).filter(function (el) { return el !== formContainer; });&#xA;    if (children.length === 1 &amp;&amp; children[0].contains &amp;&amp; children[0].contains(formContainer)) {&#xA;      var parent = formContainer.parentNode;&#xA;      var siblings = Array.prototype.slice.call(parent.children).filter(function (el) { return el !== formContainer; });&#xA;      if (siblings.length === 1 &amp;&amp; siblings[0].contains &amp;&amp; siblings[0].contains(formContainer)) {&#xA;        parent = siblings[0];&#xA;        siblings = Array.prototype.slice.call(parent.children).filter(function (el) { return el !== formContainer; });&#xA;      }&#xA;      return siblings;&#xA;    }&#xA;    return children;&#xA;  }&#xA;&#xA;  function init() {&#xA;    var main = getMain();&#xA;    formContainerRef = getFormContainer();&#xA;    var formContainer = formContainerRef;&#xA;    if (!main || !formContainer) return;&#xA;    VAR_NAMES = (formContainer.getAttribute(&#39;data-doc-vars&#39;) || &#39;RHOST,LHOST,RPORT,LPORT&#39;).split(&#39;,&#39;).map(function (s) { return s.trim(); });&#xA;&#xA;    var contentNodes = getDocContentNodes(main, formContainer);&#xA;    contentNodes = contentNodes.filter(function (node) { return !(node.contains &amp;&amp; node.contains(formContainer)); });&#xA;    if (contentNodes.length === 0) return;&#xA;    if (trueOriginals === null) trueOriginals = [];&#xA;    contentStore = contentNodes.map(function (node, idx) {&#xA;      var originalHTML;&#xA;      if (trueOriginals[idx] !== undefined) {&#xA;        originalHTML = trueOriginals[idx];&#xA;      } else {&#xA;        var raw = node.innerHTML;&#xA;        var isWrapperWithForm = (node.contains &amp;&amp; node.contains(formContainer));&#xA;        originalHTML = isWrapperWithForm ? raw.replace(formContainer.outerHTML, FORM_PLACEHOLDER) : raw;&#xA;        trueOriginals[idx] = originalHTML;&#xA;      }&#xA;      return { node: node, originalHTML: originalHTML };&#xA;    });&#xA;&#xA;    loadFromStorage();&#xA;&#xA;    function onFormInput() {&#xA;      applySubstitution();&#xA;      saveToStorage();&#xA;    }&#xA;    formContainer.addEventListener(&#39;input&#39;, onFormInput);&#xA;    formContainer.addEventListener(&#39;change&#39;, onFormInput);&#xA;&#xA;    var resetBtn = document.getElementById(&#39;doc-vars-reset&#39;);&#xA;    if (resetBtn) {&#xA;      resetBtn.addEventListener(&#39;click&#39;, resetForm);&#xA;    }&#xA;  }&#xA;&#xA;  if (document.readyState === &#39;loading&#39;) {&#xA;    document.addEventListener(&#39;DOMContentLoaded&#39;, init);&#xA;  } else {&#xA;    init();&#xA;  }&#xA;})();&#xA;&lt;/script&gt;&#xA;&#xA;&lt;p&gt;Cross-Site Request Forgery (CSRF/XSRF) occurs when a web application accepts state-changing requests without verifying that the request originated from an authenticated user&amp;rsquo;s session, allowing attackers to trick users into performing unintended actions on their behalf.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
