---
title: "Vulnerability Scanning"
date: 2025-12-30T18:50:10-08:00
draft: false
description: "Vulnerability scanning guide for penetration testing using Nmap NSE scripts, SearchSploit, OpenVAS, and specialized scanners to identify security weaknesses, misconfigurations, CVEs, and known vulnerabilities in systems and services."
noindex: false
featured: false
pinned: false
nav_weight: 5
toc: true
# comments: false
series:
#  - 
categories:
#  - 
tags:
#  - 
images:
#  - 
# menu:
#   main:
#     weight: 100
#     params:
#       icon:
#         vendor: bs
#         name: book
#         color: '#e24d0e'
meta:
  reading_time: false
---

## Vulnerability Scanning
Vulnerability scanning identifies security weaknesses, misconfigurations, and known vulnerabilities in systems and services discovered during enumeration. This phase helps prioritize targets and identify potential attack vectors.

{{< bs/alert warning >}}
{{< markdownify >}}
**Important**: Always verify vulnerability scan results manually. Automated scanners may produce false positives or miss vulnerabilities.
{{< /markdownify >}}
{{< /bs/alert >}}

## Nmap Vulnerability Scripts

Nmap's NSE (Nmap Scripting Engine) includes numerous vulnerability detection scripts that can identify known CVEs and security issues.

### General Vulnerability Scanning

**List available vulnerability scripts:**
```shell
ls /usr/share/nmap/scripts/ | grep vuln
```

**Run all vulnerability scripts:**
```shell
nmap --script vuln $RHOST
nmap --script vuln -p80,443,8080 $RHOST
```

**Safe vulnerability scripts (less intrusive):**
```shell
nmap --script "vuln and safe" $RHOST
```

**All vulnerability categories:**
```shell
nmap --script "vuln,exploit,malware" $RHOST
```

### Service-Specific Vulnerability Scripts

**HTTP vulnerabilities:**
```shell
nmap --script http-vuln-* -p 80,443,8080 $RHOST
nmap --script http-slowloris,http-methods -p 80 $RHOST
```

**SMB vulnerabilities:**
```shell
nmap --script smb-vuln-* -p 445 $RHOST
nmap --script smb-vuln-ms17-010 -p 445 $RHOST  # EternalBlue
nmap --script smb-vuln-ms08-067 -p 445 $RHOST
```

**SSH vulnerabilities:**
```shell
nmap --script sshv1,ssh-hostkey -p 22 $RHOST
```

**FTP vulnerabilities:**
```shell
nmap --script ftp-vuln-* -p 21 $RHOST
```

**DNS vulnerabilities:**
```shell
nmap --script dns-* -p 53 $RHOST
```

**SSL/TLS vulnerabilities:**
```shell
nmap --script ssl-* -p 443,8443 $RHOST
nmap --script ssl-heartbleed -p 443 $RHOST
nmap --script ssl-poodle -p 443 $RHOST
```

**Run specific vulnerability category:**
```shell
nmap --script "exploit" $RHOST
nmap --script "malware" $RHOST
nmap --script "dos" $RHOST  # Use with caution
```

---

## Exploit Database (SearchSploit)

SearchSploit provides access to the Exploit-DB database for finding exploits related to discovered vulnerabilities.

### Basic Search

**Search by service/software:**
```shell
searchsploit apache 2.4
searchsploit openssh 7.4
searchsploit wordpress
```

**Search by CVE:**
```shell
searchsploit CVE-2017-0144
searchsploit CVE-2021-44228  # Log4j
```

**Search by platform:**
```shell
searchsploit windows remote
searchsploit linux local
```

### Advanced Search

**Case-insensitive search:**
```shell
searchsploit -c apache
```

**Exact match:**
```shell
searchsploit -e "Apache 2.4.41"
```

**Search with path:**
```shell
searchsploit -p 12345  # Exploit ID
```

**Update database:**
```shell
searchsploit -u
```

### Copy Exploits

**Copy exploit to current directory:**
```shell
searchsploit -m 12345
searchsploit -m windows/remote/12345.py
```

**Copy multiple exploits:**
```shell
searchsploit -m 12345 12346 12347
```

---

## CVE Databases and Lookup

### CVE Details

**Online CVE lookup:**
- https://cve.mitre.org/
- https://www.cvedetails.com/
- https://nvd.nist.gov/

---

## Automated Vulnerability Scanning

### OpenVAS

Open-source vulnerability scanner (formerly Nessus):

**Start OpenVAS:**
```shell
gvm-setup
gvm-check-setup
```

**Access web interface:**
- Default: https://localhost:9392
- Create scans via web UI

**Command-line interface:**
```shell
omp -u admin -w password -T
omp -u admin -w password --xml="<create_task><name>Scan</name><target id='target-id'/><config id='config-id'/></create_task>"
```

### Nessus

Commercial vulnerability scanner:

**Start Nessus service:**
```shell
systemctl start nessusd
```

**Access web interface:**
- Default: https://localhost:8834
- Create and manage scans via web UI

**Nessus CLI (if available):**
```shell
nessus-cli scan list
nessus-cli scan launch <scan-id>
```

### Nikto

Web server vulnerability scanner:

**Basic scan:**
```shell
nikto -h http://$RHOST
```

**Specific ports:**
```shell
nikto -h http://$RHOST -p 80,443,8080
```

**Tuning options:**
```shell
nikto -h http://$RHOST -Tuning 1,2,3,4,5,6,7,8,9
```

>[!tip] Nikto Tuning Options
>- 1: File Upload
>- 2: Interesting File / Seen in logs
>- 3: Misconfiguration / Default Files
>- 4: Information Disclosure
>- 5: Injection (XSS/Script/HTML)
>- 6: Remote File Retrieval - Inside Web Root
>- 7: Denial of Service
>- 8: Remote File Retrieval - Server Wide
>- 9: Authentication Bypass

**Scan with authentication:**
```shell
nikto -h http://$RHOST -id admin:password
```

**Scan multiple hosts:**
```shell
nikto -h http://$RHOST -h http://$RHOST2
```

### Nuclei

Fast vulnerability scanner using community-driven templates:

**Basic vulnerability scan:**
```shell
nuclei -u http://$RHOST
nuclei -u https://$RHOST
```

**CVE-specific templates:**
```shell
nuclei -u http://$RHOST -t /path/to/templates/cves/
nuclei -u http://$RHOST -tags cve
```

**Severity filtering:**
```shell
nuclei -u http://$RHOST -s critical,high
nuclei -u http://$RHOST -severity critical,high,medium
```

**Rate limiting:**
```shell
nuclei -u http://$RHOST -rl 10 -c 5
```

**Scan from file:**
```shell
nuclei -l targets.txt
```

**Update templates:**
```shell
nuclei -update-templates
```

**Output options:**
```shell
nuclei -u http://$RHOST -o results.txt
nuclei -u http://$RHOST -o results.json -json
```

---

## Manual Vulnerability Verification

### Version Checking

**Identify service versions:**
```shell
nmap -sV -p 22,80,443 $RHOST
curl -I http://$RHOST | grep -i server
```

**Compare with known vulnerabilities:**
- Check vendor security advisories
- Review CVE database for version-specific issues
- Verify patch levels

---

## Specialized Vulnerability Scanners

### SQLMap (SQL Injection)

**Basic SQL injection test:**
```shell
sqlmap -u "http://$RHOST/page?id=1"
sqlmap -u "http://$RHOST/page?id=1" --dbs
sqlmap -u "http://$RHOST/page?id=1" -D database --tables
```

**POST request testing:**
```shell
sqlmap -u "http://$RHOST/login" --data="user=admin&pass=test"
```

**Cookie-based testing:**
```shell
sqlmap -u "http://$RHOST/page" --cookie="session=abc123"
```

### WPScan (WordPress)

**Basic WordPress scan:**
```shell
wpscan --url http://$RHOST
wpscan --url http://$RHOST --enumerate u,p,t
```

**With API token (faster):**
```shell
wpscan --url http://$RHOST --api-token YOUR_TOKEN
```

**Plugin/theme enumeration:**
```shell
wpscan --url http://$RHOST --enumerate ap,at
```

### Droopescan (CMS Scanners)

**Drupal:**
```shell
droopescan scan drupal -u http://$RHOST
```

**Joomla:**
```shell
droopescan scan joomla -u http://$RHOST
```

**WordPress:**
```shell
droopescan scan wordpress -u http://$RHOST
```

### Retire.js (JavaScript Libraries)

**Scan for vulnerable JS libraries:**
```shell
retire --path /path/to/webapp
retire --jspath /path/to/js/files
```

---

## Vulnerability Assessment Workflow

### 1. Identify Services and Versions
```shell
nmap -sV -p- $RHOST -oA service_scan
```

### 2. Search for Known Vulnerabilities
```shell
# Extract versions from scan
grep "version" service_scan.nmap

# Search Exploit-DB
searchsploit <service> <version>
```

### 3. Run Automated Scanners
```shell
nmap --script vuln $RHOST
nikto -h http://$RHOST
nuclei -u http://$RHOST
```

---

